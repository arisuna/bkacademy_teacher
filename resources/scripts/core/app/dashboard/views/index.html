<div ng-controller="DashboardController" xmlns="http://www.w3.org/1999/html">
    <div class="content-wrapper border-top-0 overflow-y-enable">
        <!--Box 1-->
        <div ng-show="isAdminOrManager" class="card-body border-radius-5 overflow-hidden pb0"
             ng-if="AppAclService.validateAction('dashboard','index')">
            <div class="row">
                <div class="col-xs-6 col-md-3 col-lg-3">
                    <div class="text-white border-radius-5 md-padding"
                         ng-class="{'relo-bg-navy-blue' : !myCompany.theme_id, 'relo-bg-secondary-color' : myCompany.theme_id}">

                        <a class="ei-icon tool-tip-hover" uib-dropdown-toggle><i
                            class="pull-right pointer fa fa-info-circle ml-sm txt-20 text-white"
                            aria-hidden="true"></i></i></a>
                        <div class="bg-black-darker text-sm text-white dropdown-menu mg-t-2x pd-1x dashboard-tooltip">
                            {{'ONGOING_RELOCATION_TOOLTIP_TEXT' | translate}}
                        </div>

                        <div>
                            <a class="text-white" ng-click="goToRelocations('FILTER_STATUS_IN_PROGRESS_TEXT')"> {{'ONGOING_RELOCATION_TEXT' | translate }}</a>
                        </div>
                        <div class="h2 mb0 mt-lg txt-number-dashboard"><a class="text-white" ng-click="goToRelocations('FILTER_STATUS_IN_PROGRESS_TEXT')">{{ relocation_on_going_count
                            }}</a>
                        </div>
                    </div>

                    <div class="md-padding text-dark-blue"
                         ng-show="showBox1">
                        <div>
                            {{ 'ASSIGNEES_ACTIVATED_TEXT' | translate }}
                            <tooltip class="ml-sm"
                                     text="{{ 'ASSIGNEES_ACTIVATED_TOOLTIP_TEXT' | translate }}"></tooltip>
                        </div>
                        <div class="h4 mt0">{{panel.activated_assignees}}/{{panel.total_assignees}}</div>

                        <div class="mt-sm">
                            {{ 'ACTIVE_ASSIGNMENTS_TEXT' | translate }}
                            <tooltip class="ml-sm" text="{{ 'ACTIVE_ASSIGNMENTS_TEXT' | translate }}"></tooltip>
                        </div>
                        <div class="h4 mt0">{{panel.ongoing_assignments}}</div>
                    </div>
                </div>

                <div class="col-xs-6 col-md-3 col-lg-3">
                    <div class="text-white border-radius-5 md-padding"
                         ng-class="{'relo-bg-navy-blue' : !myCompany.theme_id, 'relo-bg-secondary-color' : myCompany.theme_id}">
                        <a class="ei-icon tool-tip-hover" uib-dropdown-toggle><i
                            class="pull-right pointer fa fa-info-circle ml-sm txt-20 text-white"
                            aria-hidden="true"></i></i></a>
                        <div class="bg-black-darker text-sm text-white dropdown-menu mg-t-2x pd-1x dashboard-tooltip">
                            {{'ENDING_SOON_RELOCATION_TOOLTIP_TEXT' | translate}}
                        </div>
                        <div n>
                            <a class="text-white" ng-click="goToRelocations('FILTER_END_NEXT_MONTH_TEXT')">  {{ 'ENDING_SOON_RELOCATION_TEXT' | translate }}</a>
                        </div>
                        <div class="h2  mb0 mt-lg txt-number-dashboard">
                            <a class="text-white" ng-click="goToRelocations('FILTER_END_NEXT_MONTH_TEXT')">{{ relocation_ending_soon_count }}</a>
                        </div>
                    </div>


                    <div class="md-padding text-dark-blue"
                         ng-show="showBox1">
                        <div>
                            {{ 'NUMBER_OF_INVITATIONS_TEXT' | translate }}
                        </div>
                        <div class="h4 mt0">{{panel.invitations}}/{{panel.total_hr_accounts}}</div>

                        <div class="mt-sm">
                            {{ 'NUMBER_OF_SERVICE_REQUESTS_TEXT' | translate }}
                        </div>
                        <div class="h4 mt0">{{panel.requests_of_service}}</div>
                    </div>
                </div>

                <div class="col-xs-6 col-md-3 col-lg-3">
                    <div class="text-white border-radius-5 md-padding"
                         ng-class="{'relo-bg-navy-blue' : !myCompany.theme_id, 'relo-bg-secondary-color' : myCompany.theme_id}">
                        <a class="ei-icon tool-tip-hover" uib-dropdown-toggle><i
                            class="pull-right pointer fa fa-info-circle ml-sm txt-20 text-white"
                            aria-hidden="true"></i></i></a>
                        <div class="bg-black-darker text-sm text-white dropdown-menu mg-t-2x pd-1x dashboard-tooltip">
                            {{'TASK_TO_DO_TOOLTIP_TEXT' | translate}}
                        </div>
                        <div>
                            <a class="text-white" ng-click="goToTask('FILTER_STATUS_TO_DO_TEXT')">
                                {{ 'TASK_TO_DO_TEXT' | translate }}</a>
                        </div>
                        <div class="h2  mb0 mt-lg txt-number-dashboard"><a class="text-white"
                                                                           ng-click="goToTask('FILTER_STATUS_TO_DO_TEXT')">{{ task_todo_count
                            }}</a></div>
                    </div>


                    <div class="text-dark-blue md-padding" ng-show="showBox1">
                        <div>
                            {{ 'AVERAGE_N_OF_SERVICE_PER_RELOCATION_TEXT' | translate }}
                            <tooltip class="ml-sm"
                                     text="{{ 'TOOLTIP_AVERAGE_N_OF_SERVICE_PER_RELOCATION_TEXT' | translate }}"></tooltip>
                        </div>
                        <div class="h4 mt0">{{panel.average_services_per_relocation}}</div>

                        <div class="mt-sm">
                            {{ 'AVERAGE_SERVICES_DURATION' | translate }}
                            <tooltip class="ml-sm"
                                     text="{{ 'TOOLTIP_AVERAGE_SERVICES_DURATION_TEXT' | translate }}"></tooltip>
                        </div>
                        <div class="h4 mt0">{{panel.average_services_duration}} days</div>
                    </div>

                </div>

                <div class="col-xs-6 col-md-3 col-lg-3">
                    <div class="text-white border-radius-5 md-padding"
                         ng-class="{'relo-bg-navy-blue' : !myCompany.theme_id, 'relo-bg-secondary-color' : myCompany.theme_id}">
                        <a class="ei-icon tool-tip-hover" uib-dropdown-toggle><i
                            class="pull-right pointer fa fa-info-circle ml-sm txt-20 text-white"
                            aria-hidden="true"></i></i></a>
                        <div class="bg-black-darker text-sm text-white dropdown-menu mg-t-2x pd-1x dashboard-tooltip">
                            {{'ONGOING_TASK_TOOLTIP_TEXT' | translate}}
                        </div>
                        <div>
                            <a class="text-white"
                               ng-click="goToTask('FILTER_STATUS_IN_PROGRESS_TEXT')">{{ 'ONGOING_TASK_TEXT' | translate
                                }}</a>
                        </div>
                        <div class="h2  mb0 mt-lg txt-number-dashboard"><a class="text-white"
                                                                           ng-click="goToTask('FILTER_STATUS_IN_PROGRESS_TEXT')">{{ task_on_going_count
                            }}</a></div>
                    </div>


                    <div class="md-padding text-dark-blue"
                         ng-show="showBox1">

                        <div class="">
                            {{ 'CANCELLED_RELOCATIONS_TEXT' | translate }}
                        </div>
                        <div class="h4 mt0">{{panel.all_relocation_cancel}}/{{panel.all_relocation_active}}</div>
                    </div>
                </div>
            </div>

            <div ng-click="toggleBox1()"
                 class="text-center box-footer-action border-radius-5">
                <up-down-button is-down="!showBox1"
                                is-up="showBox1"
                                is-white="false"></up-down-button>
            </div>
        </div>
        <!--End Box 1-->


        <!--Box 2-->

        <div class="card-body mt-lg"
             ng-if="AppAclService.validateAction('dashboard','index')">
            <gms-member-activity
                worker="worker"
                is-admin="isAdminOrManager"
                ng-if="worker.id > 0"></gms-member-activity>
        </div>


        <!--<div class="row">-->
        <!--<div class="col-sm-6">-->
        <!--<dashboard-multi-list obj="assessment"></dashboard-multi-list>-->
        <!--</div>-->

        <!--<div class="col-sm-6">-->
        <!--<dashboard-multi-list obj="communication"></dashboard-multi-list>-->
        <!--</div>-->
        <!--</div>-->

        <div class="row">
            <div class="col-sm-6">
                <dashboard-multi-list obj="task"></dashboard-multi-list>
            </div>

            <div class="col-sm-6">
                <!--<dashboard-multi-list data="dataTest4"></dashboard-multi-list>-->
                <gms-dashboard-multi-list-reminder></gms-dashboard-multi-list-reminder>
            </div>
        </div>

        <div ng-show="isAdminOrManager" class="row">
            <div class="col-sm-6">
                <div class="panel panel-default white-block gms-team-activities pb0 bd-top-width-1px">
                    <div class="panel-heading panel-light-gray">
                        <div class="flex" ng-style="{ 'height': headerHeight + 'px' }">
                            <span class="flex-1 inline-flex mt-sm">
                                <h4 class="mg-0 txt-bold inline-block">{{ 'TOP_ACCOUNTS_TEXT' | translate }}</h4>
                                <tooltip class="ml-sm"
                                         text="{{'DASHBOARD_RELOCATION_TOP_HR_TOOLTIP_TEXT' | translate}}"></tooltip>
                            </span>
                            <span class="flex-middle">
                                <gms-date-search-filter module-name="searchModules.topAccount.name"
                                                        no-margin="true"
                                                        is-dropdown-right="true"
                                                        all-label="ALL_TIME_TEXT"></gms-date-search-filter>
                            </span>
                        </div>
                    </div>
                    <div class="panel-body pb0">
                        <spinner-v2 type="spin" ng-show="topAccountLoading"></spinner-v2>
                        <div class="row pd-b-1x" ng-show="!topAccountLoading">
                            <div class="col-md-12 text-center h-60" ng-show="accounts.length == 0">
                                <span>{{'NO_DATA_AVAILABLE_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="accounts[0].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">1</span><sup
                                    class="sup">st</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{accounts[0].company_name}}</strong>
                                <span>{{accounts[0].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="accounts[1].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">2</span><sup
                                    class="sup">nd</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{accounts[1].company_name}}</strong>
                                <span>{{accounts[1].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="accounts[2].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">3</span><sup
                                    class="sup">rd</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{accounts[2].company_name}}</strong>
                                <span>{{accounts[2].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                        </div>

                        <angular-table search-input-enable="false"
                                       table="table"
                                       items="accounts"
                                       pagination-enable="false"
                                       ng-show="showTopAccount && !topAccountLoading">
                            <table class="table table-striped table-hover">
                                <tbody>
                                <tr ng-repeat="item in accounts track by $index" class="pd-t-1x" ng-if="$index > 2">
                                    <td><strong>#{{$index + 1}}</strong></td>
                                    <td>{{item.company_name}}</td>
                                    <td>{{item.count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </angular-table>
                        <div ng-click="toggleTopAccount()" class="text-center box-footer-action border-radius-5">
                            <up-down-button is-down="showTopAccount"
                                            is-up="!showTopAccount"></up-down-button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-sm-6">
                <div class="panel panel-default white-block gms-team-activities pb0 bd-top-width-1px">
                    <div class="panel-heading panel-light-gray">
                        <div class="flex" ng-style="{ 'height': headerHeight + 'px' }">
                            <span class="flex-1 inline-flex mt-sm">
                                <h4 class="mg-0 txt-bold inline-block">{{ 'TOP_BOOKERS_TEXT' | translate }}</h4>
                                <tooltip class="ml-sm"
                                         text="{{'DASHBOARD_RELOCATION_TOP_BOOKER_TOOLTIP_TEXT' | translate}}"></tooltip>
                            </span>
                            <span class="flex-middle">
                                <gms-date-search-filter module-name="searchModules.topBooker.name"
                                                        no-margin="true"
                                                        is-dropdown-right="true"
                                                        all-label="ALL_TIME_TEXT"></gms-date-search-filter>
                            </span>
                        </div>
                    </div>
                    <div class="panel-body pb0">
                        <spinner-v2 type="spin" ng-show="topBookerLoading"></spinner-v2>
                        <div class="row pd-b-1x" ng-show="!topBookerLoading">
                            <div class="col-md-12 text-center h-60" ng-show="bookers.length == 0">
                                <span>{{'NO_DATA_AVAILABLE_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="bookers[0].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">1</span><sup
                                    class="sup">st</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{bookers[0].company_name}}</strong>
                                <span>{{bookers[0].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="bookers[1].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">2</span><sup
                                    class="sup">nd</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{bookers[1].company_name}}</strong>
                                <span>{{bookers[1].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                            <div class="col-sm-4 text-center" ng-if="bookers[2].count_relocation > 0">
                                <span class="text-dark-blue mg-0 pd-0"><span class="txt-number-dashboard">3</span><sup
                                    class="sup">rd</sup></span>
                                <br/>
                                <strong class="max-lines-2">{{bookers[2].company_name}}</strong>
                                <span>{{bookers[2].count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</span>
                            </div>
                        </div>

                        <angular-table search-input-enable="false"
                                       table="table"
                                       items="bookers"
                                       pagination-enable="false"
                                       ng-show="showTopBooker && !topBookerLoading">
                            <table class="table table-striped table-hover">
                                <tbody>
                                <tr ng-repeat="item in bookers track by $index" class="pd-t-1x" ng-if="$index > 2">
                                    <td><strong>#{{$index + 1}}</strong></td>
                                    <td>{{item.company_name}}</td>
                                    <td>{{item.count_relocation}} {{'RELOCATIONS_TEXT' | translate}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </angular-table>
                        <div ng-click="toggleTopBooker()" class="text-center box-footer-action border-radius-5">
                            <up-down-button is-down="!showTopBooker"
                                            is-up="showTopBooker"></up-down-button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <ng-include src="mapCountryUrl"></ng-include>

        <!--Box activity-->
        <div class="card-body" ng-if="AppAclService.validateAction('dashboard','index')">
            <div class="row">
                <div class="col-md-12">
                    <!-- Head -->
                    <div class="panel panel-default white-block gms-team-activities bd-top-width-1px">
                        <div class="panel-heading">
                            <div class="flex" ng-style="{ 'height': headerHeight + 'px' }">
                                <span class="inline-flex mt-sm"><h4
                                    class="mg-0 txt-bold inline-block">{{ 'ACTIVITY_FEED_TEXT' | translate
                                    }}</h4></span>
                            </div>
                        </div>
                        <div class="panel-body pd-0 height-50vh overflow-y-enable">
                            <activity-block module="dashboard" ng-if="isAdminOrManager"></activity-block>

                            <activity-block module="member" ng-if="!isAdminOrManager" uuid="{{currentUser.uuid}}"></activity-block>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</div>
